<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>A tutorial for InSAR data in CSI &#8212; CSI 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=62c01f10" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=f78ba3b0" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script src="../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=e637711f"></script>
    <script src="../_static/copybutton.js?v=56c01ce6"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Aseismic slip rate inversion" href="tutoInversionCreep.html" />
    <link rel="prev" title="Basic Tutorials" href="../basictutorials.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="A-tutorial-for-InSAR-data-in-CSI">
<h1>A tutorial for InSAR data in CSI<a class="headerlink" href="#A-tutorial-for-InSAR-data-in-CSI" title="Link to this heading">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#------------------------------------------------------------------</span>
<span class="c1">#------------------------------------------------------------------</span>
<span class="c1">#</span>
<span class="c1">#            Plotting, Downsampling and computing covariance</span>
<span class="c1">#                           for InSAR data</span>
<span class="c1">#</span>
<span class="c1">#------------------------------------------------------------------</span>
<span class="c1">#------------------------------------------------------------------</span>

<span class="c1"># Import personal libraries</span>
<span class="kn">import</span> <span class="nn">csi.TriangularPatches</span> <span class="k">as</span> <span class="nn">triangleflt</span>
<span class="kn">import</span> <span class="nn">csi.insar</span> <span class="k">as</span> <span class="nn">insar</span>
<span class="kn">import</span> <span class="nn">csi.imagedownsampling</span> <span class="k">as</span> <span class="nn">imdown</span>
<span class="kn">import</span> <span class="nn">csi.imagecovariance</span> <span class="k">as</span> <span class="nn">imcov</span>

<span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">copy</span>

<span class="c1"># Matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.path</span> <span class="k">as</span> <span class="nn">path</span>

<span class="c1"># Nice colors</span>
<span class="kn">from</span> <span class="nn">cmcrameri</span> <span class="kn">import</span> <span class="n">cm</span>

<span class="c1"># F*** off warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Some styling changes</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelweight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;x-large&#39;</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.titlesize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;xx-large&#39;</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.titleweight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span>

<span class="c1"># Reference</span>
<span class="n">lon0</span><span class="o">=</span><span class="mf">33.0</span>
<span class="n">lat0</span><span class="o">=</span><span class="mf">40.8</span>
</pre></div>
</div>
</div>
<section id="Create-a-fault-object">
<h2>Create a fault object<a class="headerlink" href="#Create-a-fault-object" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import fault</span>
<span class="n">intrace</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="s1">&#39;DataAndModels/NAF.xy&#39;</span><span class="p">)</span>
<span class="n">ingeomt</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="s1">&#39;DataAndModels/NAF.triangles&#39;</span><span class="p">)</span>

<span class="c1"># Create the fault</span>
<span class="n">naf</span> <span class="o">=</span> <span class="n">triangleflt</span><span class="p">(</span><span class="s1">&#39;North Anatolian Fault&#39;</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="n">lat0</span><span class="p">)</span>

<span class="c1"># Read the trace of the fault (mostly for plotting purposes)</span>
<span class="n">naf</span><span class="o">.</span><span class="n">file2trace</span><span class="p">(</span><span class="n">intrace</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Read the triangular mesh of the fault</span>
<span class="c1"># This one has been built using PyDistMesh, a Python implementation of DistMesh (Persson, 2004)</span>
<span class="n">naf</span><span class="o">.</span><span class="n">readGocadPatches</span><span class="p">(</span><span class="n">ingeomt</span><span class="p">)</span>

<span class="c1"># For later plotting</span>
<span class="n">naf</span><span class="o">.</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span>
<span class="n">naf</span><span class="o">.</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initializing fault North Anatolian Fault
</pre></div></div>
</div>
</section>
<section id="Read-and-plot-the-InSAR-data">
<h2>Read and plot the InSAR data<a class="headerlink" href="#Read-and-plot-the-InSAR-data" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For simplicity, we directly use a binary file. Some readers are available in CSI, but since there is an infinite</span>
<span class="c1"># number of ways to store InSAR data (almost...), it is better to use a custom reader. Build your own and make it</span>
<span class="c1"># to binary format.</span>
<span class="c1"># If you feel like contributing, be my guest and implement your own in CSI.</span>
<span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2200</span><span class="p">,</span> <span class="mi">2068</span><span class="p">)</span>

<span class="c1"># Read the velocity map</span>
<span class="n">velocity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="s1">&#39;DataAndModels/NAFvel.flt&#39;</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
<span class="n">uncertainty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="s1">&#39;DataAndModels/NAFerr.flt&#39;</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>

<span class="c1"># Read the rms map</span>
<span class="n">rms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="s1">&#39;DataAndModels/NAFrms.flt&#39;</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
<span class="n">nifg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="s1">&#39;DataAndModels/NAFnifg.flt&#39;</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>

<span class="c1"># Read lon lat</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="s1">&#39;DataAndModels/NAFlon.flt&#39;</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="s1">&#39;DataAndModels/NAFlat.flt&#39;</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>

<span class="c1"># Line-of-sight</span>
<span class="n">los</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="s1">&#39;DataAndModels/NAFlos.flt&#39;</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<span class="n">inc</span> <span class="o">=</span> <span class="n">los</span><span class="p">[:,:</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">azi</span> <span class="o">=</span> <span class="n">los</span><span class="p">[:,</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span>

<span class="c1"># Mask to clean things up</span>
<span class="n">velocity</span><span class="p">[</span><span class="n">rms</span><span class="o">&gt;</span><span class="mf">3.</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">velocity</span><span class="p">[</span><span class="n">velocity</span><span class="o">==</span><span class="mf">0.</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">velocity</span><span class="p">[</span><span class="n">nifg</span><span class="o">&lt;</span><span class="mi">500</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">velocity</span><span class="p">[</span><span class="n">uncertainty</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make a velocity object</span>
<span class="n">rate</span> <span class="o">=</span> <span class="n">insar</span><span class="p">(</span><span class="s1">&#39;Rate map T167&#39;</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="n">lat0</span><span class="p">)</span>

<span class="c1"># Read the binary data into the object</span>
<span class="c1"># Note that these arrays could be files</span>
<span class="n">rate</span><span class="o">.</span><span class="n">read_from_binary</span><span class="p">(</span><span class="n">velocity</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">remove_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_zeros</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">incidence</span><span class="o">=</span><span class="n">inc</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">azi</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

<span class="c1"># Here, we remove the NaNs</span>
<span class="n">rate</span><span class="o">.</span><span class="n">checkNaNs</span><span class="p">()</span>

<span class="c1"># Here, we find the points that are more that 60 km away from the fault</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">rate</span><span class="o">.</span><span class="n">getDistance2Faults</span><span class="p">(</span><span class="n">naf</span><span class="p">)</span>

<span class="c1"># We set these to NaNs</span>
<span class="n">rate</span><span class="o">.</span><span class="n">vel</span><span class="p">[</span><span class="n">d</span><span class="o">&gt;</span><span class="mf">60.</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">rate</span><span class="o">.</span><span class="n">vel</span><span class="p">[</span><span class="n">d</span><span class="o">&lt;</span><span class="mf">1.</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="c1"># And we remove them</span>
<span class="n">rate</span><span class="o">.</span><span class="n">checkNaNs</span><span class="p">()</span>

<span class="c1"># Show me</span>
<span class="c1"># The shaded topo argument will only work if 1. cartopy fixes the way they download the data, or 2. if you have downloaded and unzipped the tiles yourself and</span>
<span class="c1"># pasted these in the .local/share/cartopy/SRTM/SRTMGL1 folder. If you want, you can comment this argument.</span>
<span class="n">rate</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plotType</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
          <span class="n">drawCoastlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">faults</span><span class="o">=</span><span class="n">naf</span><span class="p">,</span> <span class="n">seacolor</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma</span><span class="p">,</span>
          <span class="n">shadedtopo</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;srtm&#39;</span><span class="p">,</span> <span class="s1">&#39;smooth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>

<span class="c1"># The plotType argument can be &#39;scatter&#39;, &#39;decimate&#39; or &#39;flat&#39;.</span>
<span class="c1"># The &#39;scatter&#39; option will plot the data as a scatter plot, with the color of the points representing the velocity.</span>
<span class="c1"># The &#39;decimate&#39; option will look for the decimation pattern in the insar object (see below) and plot the data as squares over the decimated grid.</span>
<span class="c1"># The &#39;flat&#39; option will plot the data as a contourf image, using the nx and ny arguments to define the number of points in the x and y axis. If there is no NaNs, the plot is not nice as it interpolates.</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initialize InSAR data set Rate map T167
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInSAR_6_1.png" src="../_images/notebooks_tutoInSAR_6_1.png" />
</div>
</div>
<p>Now this map is not very pretty but can be customized, first with the arguments of the plot method but also using the figure object directly. For instance, we can change the colorbar position, size and its label</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rate</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plotType</span><span class="o">=</span><span class="s1">&#39;flat&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
          <span class="n">drawCoastlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">faults</span><span class="o">=</span><span class="n">naf</span><span class="p">,</span> <span class="n">seacolor</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma</span><span class="p">,</span>
          <span class="n">cbaxis</span><span class="o">=</span><span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;LOS velocity (mm/yr)&#39;</span><span class="p">,</span>
          <span class="n">shadedtopo</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;srtm&#39;</span><span class="p">,</span> <span class="s1">&#39;smooth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Carefull: there is no NaNs, the interpolation might be a whole load of garbage...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInSAR_8_1.png" src="../_images/notebooks_tutoInSAR_8_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># You can see there is some weird color patches here and there, corresponding to the interpolation used for the flat option.</span>
<span class="c1"># This is why we use the scatter option for the first plot. Now, if we want to use the flat option, we can just keep the NaNs and interpolate.</span>

<span class="c1"># Make a velocity object</span>
<span class="n">rate</span> <span class="o">=</span> <span class="n">insar</span><span class="p">(</span><span class="s1">&#39;Rate map T167&#39;</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="n">lat0</span><span class="p">)</span>

<span class="c1"># Read the binary data into the object</span>
<span class="c1"># Note that these arrays could be files</span>
<span class="n">rate</span><span class="o">.</span><span class="n">read_from_binary</span><span class="p">(</span><span class="n">velocity</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">remove_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zeros</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">incidence</span><span class="o">=</span><span class="n">inc</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">azi</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

<span class="c1"># Here, we find the points that are more that 60 km away from the fault</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">rate</span><span class="o">.</span><span class="n">getDistance2Faults</span><span class="p">(</span><span class="n">naf</span><span class="p">)</span>

<span class="c1"># We set these to NaNs</span>
<span class="n">rate</span><span class="o">.</span><span class="n">vel</span><span class="p">[</span><span class="n">d</span><span class="o">&gt;</span><span class="mf">60.</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">rate</span><span class="o">.</span><span class="n">vel</span><span class="p">[</span><span class="n">d</span><span class="o">&lt;</span><span class="mf">1.</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="c1"># Show me</span>
<span class="c1"># Since we have not removed the NaNs, the image might be larger than the zone of the interest, so we provide the box argument to zoom in.</span>
<span class="n">rate</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plotType</span><span class="o">=</span><span class="s1">&#39;flat&#39;</span><span class="p">,</span>  <span class="c1"># Plot style</span>
          <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>   <span class="c1"># Colorbar limits</span>
          <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="c1"># Figure size</span>
          <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>        <span class="c1"># Transparency</span>
          <span class="n">box</span><span class="o">=</span><span class="p">[</span><span class="mf">32.</span><span class="p">,</span> <span class="mf">36.</span><span class="p">,</span> <span class="mf">39.80</span><span class="p">,</span> <span class="mf">42.05</span><span class="p">],</span> <span class="c1"># Map extent</span>
          <span class="n">drawCoastlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Draw coastlines</span>
          <span class="n">faults</span><span class="o">=</span><span class="n">naf</span><span class="p">,</span>       <span class="c1"># Add a fault trace</span>
          <span class="n">seacolor</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span> <span class="c1"># Sea color</span>
          <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma</span><span class="p">,</span>     <span class="c1"># InSAR colormap</span>
          <span class="n">cbaxis</span><span class="o">=</span><span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span>  <span class="c1"># Colorbar position</span>
          <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;LOS velocity (mm/yr)&#39;</span><span class="p">,</span>  <span class="c1"># Colorbar label</span>
          <span class="n">shadedtopo</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;srtm&#39;</span><span class="p">,</span> <span class="s1">&#39;smooth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">})</span>    <span class="c1"># Shaded topography</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initialize InSAR data set Rate map T167
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInSAR_9_1.png" src="../_images/notebooks_tutoInSAR_9_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># And we can add faults on top of this map</span>

<span class="c1"># Make a figure</span>
<span class="n">rate</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plotType</span><span class="o">=</span><span class="s1">&#39;flat&#39;</span><span class="p">,</span>  <span class="c1"># Plot style</span>
          <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>   <span class="c1"># Colorbar limits</span>
          <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="c1"># Figure size</span>
          <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>        <span class="c1"># Transparency</span>
          <span class="n">box</span><span class="o">=</span><span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mf">39.80</span><span class="p">,</span> <span class="mf">42.05</span><span class="p">],</span> <span class="c1"># Map extent</span>
          <span class="n">drawCoastlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Draw coastlines</span>
          <span class="n">faults</span><span class="o">=</span><span class="n">naf</span><span class="p">,</span>       <span class="c1"># Add a fault trace</span>
          <span class="n">seacolor</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span> <span class="c1"># Sea color</span>
          <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma</span><span class="p">,</span>     <span class="c1"># InSAR colormap</span>
          <span class="n">cbaxis</span><span class="o">=</span><span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span>  <span class="c1"># Colorbar position</span>
          <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;LOS velocity (mm/yr)&#39;</span><span class="p">,</span>  <span class="c1"># Colorbar label</span>
          <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>       <span class="c1"># Do not show the figure so that we can modify it later</span>
          <span class="n">shadedtopo</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;srtm&#39;</span><span class="p">,</span> <span class="s1">&#39;smooth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;zorder&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>    <span class="c1"># Shaded topography</span>

<span class="c1"># Get the correct axis (carte means map in French. Yes, I am French)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">rate</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">carte</span>

<span class="c1"># Make a polygon with the four corners of the map (so that we do not plot the faults outside of the map)</span>
<span class="c1"># otherwise, it makes a hideous figure with lots of lines outside the axis</span>
<span class="c1"># I don&#39;t understand why this is not implemented already in the figure object (maybe I am doing something wrong)</span>
<span class="n">poly</span> <span class="o">=</span> <span class="p">[[</span><span class="n">rate</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">carte</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rate</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">carte</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()[</span><span class="mi">2</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">rate</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">carte</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rate</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">carte</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()[</span><span class="mi">2</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">rate</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">carte</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rate</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">carte</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()[</span><span class="mi">3</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">rate</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">carte</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rate</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">carte</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()[</span><span class="mi">3</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">rate</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">carte</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rate</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">carte</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()[</span><span class="mi">2</span><span class="p">]]]</span>

<span class="c1"># We make it a matplotlib path</span>
<span class="n">area</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">Path</span><span class="p">([[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">poly</span><span class="p">],</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># We read the fault into segments</span>
<span class="n">fin</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="s1">&#39;DataAndModels/AnatoliaFaults.dat&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">Segments</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">segment</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">NAF</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fin</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">segment</span> <span class="o">!=</span> <span class="p">[]:</span> <span class="n">Segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">])))</span>

<span class="c1"># We plot the fault if it is in the map</span>
<span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">Segments</span><span class="p">:</span>
    <span class="n">lon</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">segment</span><span class="p">]</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">segment</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">area</span><span class="o">.</span><span class="n">contains_points</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">segment</span><span class="p">))</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">NAF</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
<span class="n">fin</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Now we want to show the figure but not the fault in 3D that is in the figure object</span>
<span class="n">rate</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">showFig</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;map&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInSAR_10_0.png" src="../_images/notebooks_tutoInSAR_10_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can also check the LOS values. The LOS vector is stored in the los attribute of the insar object</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="c1"># We plot the first component of the LOS vector</span>
<span class="n">gc</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rate</span><span class="o">.</span><span class="n">lon</span><span class="p">[::</span><span class="mi">20</span><span class="p">],</span> <span class="n">rate</span><span class="o">.</span><span class="n">lat</span><span class="p">[::</span><span class="mi">20</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">rate</span><span class="o">.</span><span class="n">los</span><span class="p">[::</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">batlow</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;X component&#39;</span><span class="p">)</span>

<span class="c1"># We plot the second component of the LOS vector</span>
<span class="n">gc</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rate</span><span class="o">.</span><span class="n">lon</span><span class="p">[::</span><span class="mi">20</span><span class="p">],</span> <span class="n">rate</span><span class="o">.</span><span class="n">lat</span><span class="p">[::</span><span class="mi">20</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">rate</span><span class="o">.</span><span class="n">los</span><span class="p">[::</span><span class="mi">20</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">batlow</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Y component&#39;</span><span class="p">)</span>

<span class="c1"># We plot the third component of the LOS vector</span>
<span class="n">gc</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rate</span><span class="o">.</span><span class="n">lon</span><span class="p">[::</span><span class="mi">20</span><span class="p">],</span> <span class="n">rate</span><span class="o">.</span><span class="n">lat</span><span class="p">[::</span><span class="mi">20</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">rate</span><span class="o">.</span><span class="n">los</span><span class="p">[::</span><span class="mi">20</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">batlow</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Z component&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInSAR_11_0.png" src="../_images/notebooks_tutoInSAR_11_0.png" />
</div>
</div>
</section>
<section id="Taking-profiles-across-the-image">
<h2>Taking profiles across the image<a class="headerlink" href="#Taking-profiles-across-the-image" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We do not want to include the NaNs in the downsampling, so we first remove the NaNs from the object.</span>
<span class="c1"># Make a velocity object</span>
<span class="n">rate</span> <span class="o">=</span> <span class="n">insar</span><span class="p">(</span><span class="s1">&#39;Rate map T167&#39;</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="n">lat0</span><span class="p">)</span>

<span class="c1"># Read the binary data into the object</span>
<span class="c1"># Note that these arrays could be files</span>
<span class="n">rate</span><span class="o">.</span><span class="n">read_from_binary</span><span class="p">(</span><span class="n">velocity</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">remove_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zeros</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">incidence</span><span class="o">=</span><span class="n">inc</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">azi</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

<span class="c1"># We can keep a copy, just to make sure</span>
<span class="n">allrate</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span>

<span class="c1"># Here, we remove the NaNs</span>
<span class="n">rate</span><span class="o">.</span><span class="n">checkNaNs</span><span class="p">()</span>

<span class="c1"># Here, we find the points that are more that 60 km away from the fault</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">rate</span><span class="o">.</span><span class="n">getDistance2Faults</span><span class="p">(</span><span class="n">naf</span><span class="p">)</span>

<span class="c1"># We set these to NaNs</span>
<span class="n">rate</span><span class="o">.</span><span class="n">vel</span><span class="p">[</span><span class="n">d</span><span class="o">&gt;</span><span class="mf">60.</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">rate</span><span class="o">.</span><span class="n">vel</span><span class="p">[</span><span class="n">d</span><span class="o">&lt;</span><span class="mf">1.</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="c1"># And we remove them</span>
<span class="n">rate</span><span class="o">.</span><span class="n">checkNaNs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initialize InSAR data set Rate map T167
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[9], line 7</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> rate <span style="color: rgb(98,98,98)">=</span> insar(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">Rate map T167</span><span style="color: rgb(175,0,0)">&#39;</span>, lon0<span style="color: rgb(98,98,98)">=</span>lon0, lat0<span style="color: rgb(98,98,98)">=</span>lat0)
<span class="ansi-green-intense-fg ansi-bold">      5</span> <span style="color: rgb(95,135,135)"># Read the binary data into the object</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span> <span style="color: rgb(95,135,135)"># Note that these arrays could be files</span>
<span class="ansi-green-fg">----&gt; 7</span> <span class="ansi-yellow-bg">rate</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">read_from_binary</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">velocity</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">lon</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">lat</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">err</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">None</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span>
<span class="ansi-green-intense-fg ansi-bold">      8</span> <span class="ansi-yellow-bg">                      </span><span class="ansi-yellow-bg">remove_nan</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">False</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">remove_zeros</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">False</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span>
<span class="ansi-green-intense-fg ansi-bold">      9</span> <span class="ansi-yellow-bg">                      </span><span class="ansi-yellow-bg">incidence</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">inc</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">flatten</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">azimuth</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">azi</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">flatten</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     11</span> <span style="color: rgb(95,135,135)"># We can keep a copy, just to make sure</span>
<span class="ansi-green-intense-fg ansi-bold">     12</span> allrate <span style="color: rgb(98,98,98)">=</span> copy<span style="color: rgb(98,98,98)">.</span>deepcopy(rate)

File <span class="ansi-green-fg">~/MYBIN/csi/insar.py:477</span>, in <span class="ansi-cyan-fg">insar.read_from_binary</span><span class="ansi-blue-fg">(self, data, lon, lat, err, factor, step, incidence, heading, azimuth, los, dtype, remove_nan, downsample, remove_zeros)</span>
<span class="ansi-green-intense-fg ansi-bold">    475</span>     lon <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>fromfile(lon, dtype<span style="color: rgb(98,98,98)">=</span>dtype)[::downsample]
<span class="ansi-green-intense-fg ansi-bold">    476</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 477</span>     lon <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">lon</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">flatten</span>()[::downsample]
<span class="ansi-green-intense-fg ansi-bold">    479</span> <span style="color: rgb(95,135,135)"># Get the lat</span>
<span class="ansi-green-intense-fg ansi-bold">    480</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">type</span>(lat) <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span style="color: rgb(0,135,0)">str</span>:

<span class="ansi-red-fg">AttributeError</span>: &#39;list&#39; object has no attribute &#39;flatten&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can make profiles across the data to see what it looks like</span>
<span class="n">rate</span><span class="o">.</span><span class="n">getprofile</span><span class="p">(</span><span class="s1">&#39;Creep&#39;</span><span class="p">,</span> <span class="mf">32.8</span><span class="p">,</span> <span class="mf">40.8</span><span class="p">,</span> <span class="mf">90.</span><span class="p">,</span> <span class="mf">175.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This shows where the profile is and how it looks like</span>
<span class="n">rate</span><span class="o">.</span><span class="n">plotprofile</span><span class="p">(</span><span class="s1">&#39;Creep&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">cbaxis</span><span class="o">=</span><span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">fault</span><span class="o">=</span><span class="n">naf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInSAR_15_0.png" src="../_images/notebooks_tutoInSAR_15_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInSAR_15_1.png" src="../_images/notebooks_tutoInSAR_15_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Each profile is stored in a dictionnary in the insar object. Lots of information is stored with it.</span>
<span class="nb">print</span><span class="p">([</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rate</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="s1">&#39;Creep&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;Center&#39;, &#39;Length&#39;, &#39;Width&#39;, &#39;Box&#39;, &#39;Lon&#39;, &#39;Lat&#39;, &#39;LOS Velocity&#39;, &#39;LOS Synthetics&#39;, &#39;LOS Error&#39;, &#39;Distance&#39;, &#39;Normal Distance&#39;, &#39;EndPoints&#39;, &#39;EndPointsLL&#39;, &#39;LOS vector&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># If you want to find the intersection of the fault with the profile, you can use the intersectProfile method</span>
<span class="c1"># This method is used in the plotting method when you provide the fualt argument (it only uses the fault trace though)</span>
<span class="n">xnaf</span> <span class="o">=</span> <span class="n">rate</span><span class="o">.</span><span class="n">intersectProfileFault</span><span class="p">(</span><span class="s1">&#39;Creep&#39;</span><span class="p">,</span> <span class="n">naf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The NAF crosses the profile at km </span><span class="si">{</span><span class="n">xnaf</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The NAF crosses the profile at km -10.719261697458444
</pre></div></div>
</div>
</section>
<section id="Data-decimation">
<h2>Data decimation<a class="headerlink" href="#Data-decimation" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We do not want to include the NaNs in the downsampling, so we first remove the NaNs from the object.</span>
<span class="c1"># Make a velocity object</span>
<span class="n">rate</span> <span class="o">=</span> <span class="n">insar</span><span class="p">(</span><span class="s1">&#39;Rate map T167&#39;</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="n">lat0</span><span class="p">)</span>

<span class="c1"># Read the binary data into the object</span>
<span class="c1"># Note that these arrays could be files</span>
<span class="n">rate</span><span class="o">.</span><span class="n">read_from_binary</span><span class="p">(</span><span class="n">velocity</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">remove_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zeros</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">incidence</span><span class="o">=</span><span class="n">inc</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">azi</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

<span class="c1"># We can keep a copy, just to make sure</span>
<span class="n">allrate</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span>

<span class="c1"># Here, we remove the NaNs</span>
<span class="n">rate</span><span class="o">.</span><span class="n">checkNaNs</span><span class="p">()</span>

<span class="c1"># Here, we find the points that are more that 60 km away from the fault</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">rate</span><span class="o">.</span><span class="n">getDistance2Faults</span><span class="p">(</span><span class="n">naf</span><span class="p">)</span>

<span class="c1"># We set these to NaNs</span>
<span class="n">rate</span><span class="o">.</span><span class="n">vel</span><span class="p">[</span><span class="n">d</span><span class="o">&gt;</span><span class="mf">60.</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">rate</span><span class="o">.</span><span class="n">vel</span><span class="p">[</span><span class="n">d</span><span class="o">&lt;</span><span class="mf">1.</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="c1"># And we remove them</span>
<span class="n">rate</span><span class="o">.</span><span class="n">checkNaNs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initialize InSAR data set Rate map T167
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the downsampling object</span>
<span class="n">downsampler</span> <span class="o">=</span> <span class="n">imdown</span><span class="p">(</span><span class="s1">&#39;Downsampling </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rate</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">rate</span><span class="p">,</span> <span class="n">naf</span><span class="p">)</span>

<span class="c1"># Create an initial state</span>
<span class="c1"># Downsampling window have an initiali size of 15 kilometers</span>
<span class="c1"># The minimum downsampling size will be 2 km</span>
<span class="c1"># The tolerance is set to 0.08 km</span>
<span class="c1"># We do not plot the initial state</span>
<span class="n">downsampler</span><span class="o">.</span><span class="n">initialstate</span><span class="p">(</span><span class="mf">15.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Compute Resolution (Uncomment to have an idea of the threshold)</span>
<span class="c1">#downsampler.computeResolution(&#39;s&#39;, 0.001, vertical=True)</span>
<span class="c1">#print(&#39;Maximum Resolution: {}&#39;.format(downsampler.Rd.max()))</span>
<span class="c1">#print(&#39;Minimum Resolution: {}&#39;.format(downsampler.Rd.min()))</span>

<span class="c1"># Run the downsampling iterations until Resolution is &lt; threshold</span>
<span class="c1"># This approach is described in Lohmann and Simons, 2005</span>
<span class="c1"># The quadtree based method is also described in Sudhaus and Jonsson 2009</span>
<span class="n">downsampler</span><span class="o">.</span><span class="n">resolutionBased</span><span class="p">(</span><span class="mf">0.002</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">slipdirection</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span>           <span class="c1"># Resolution threshold, minimum downsampling size, slip direction</span>
                            <span class="n">vertical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verboseLevel</span><span class="o">=</span><span class="s1">&#39;high&#39;</span><span class="p">,</span>     <span class="c1"># Use the vertical displacement in the Green&#39;s functions, verbose level</span>
                            <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>                <span class="c1"># Decimation factor for plotting, plot the results</span>

<span class="c1"># Alternatively, run the distance-based downsampling</span>
<span class="c1">#downsampler.distanceBased(chardist=2., plot=False, expodist=1.)</span>

<span class="c1"># Or the data based downsampling (works well for the case of earthquakes since the displacement is clearly larger than the noise)</span>
<span class="c1">#dowsampler.dataBased(0.002)    # This has not been tested for this case</span>

<span class="c1"># Reject downsampled pixels that are too close to the fault. These might include data that has been average across the fault</span>
<span class="n">downsampler</span><span class="o">.</span><span class="n">newimage</span><span class="o">.</span><span class="n">reject_pixels_fault</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">naf</span><span class="p">)</span>

<span class="c1"># We note that the downsampling pattern uses a north-south grid orientation. One could work on changing this to use a more complex downsampling shape.</span>
<span class="c1"># One idea would be to use Voronoi cells, but I havent&#39; implemented this yet (as always, be my guest)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initialize InSAR downsampling tools Downsampling Rate map T167
Effective pixel spacing: 0.12614176710505537
---------------------------------
---------------------------------
Downsampling Iterations
Iteration 1: Testing 153 data samples
 ===&gt; Resolution from 8.398547783462052e-07 to 0.04800860009664166, Mean = 0.0017998034123640387 +- 0.0055843980841027
Iteration 2: Testing 219 data samples
 ===&gt; Resolution from 8.039541499305689e-07 to 0.04275711900304684, Mean = 0.004106768462994146 +- 0.007924265376307594
Iteration 3: Testing 445 data samples
 ===&gt; Resolution from 7.2054964516758e-07 to 0.15446108148818877, Mean = 0.007437430045122729 +- 0.01409105726990032
Iteration 4: Testing 1254 data samples
 ===&gt; Resolution from 0.0 to 0.0016716717085671563, Mean = 5.328954829784081e-05 +- 0.00024036501284647652

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show me the results</span>

<span class="c1"># The image attribute of the downsampler is the original image (I think it is a pointer to the original rate object)</span>
<span class="c1"># The new, downsampled dataset is the attribute newimage. It is also an insar object. It also has an attribute corner which includes the corners of the downsampling boxes.</span>

<span class="n">downsampler</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plotType</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span>
                       <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma</span><span class="p">,</span> <span class="n">cbaxis</span><span class="o">=</span><span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;LOS velocity (mm/yr)&#39;</span><span class="p">)</span>
<span class="n">downsampler</span><span class="o">.</span><span class="n">newimage</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plotType</span><span class="o">=</span><span class="s1">&#39;decimate&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span> <span class="n">edgewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                          <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma</span><span class="p">,</span> <span class="n">cbaxis</span><span class="o">=</span><span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;LOS velocity (mm/yr)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInSAR_21_0.png" src="../_images/notebooks_tutoInSAR_21_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInSAR_21_1.png" src="../_images/notebooks_tutoInSAR_21_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take two profiles and plot them to illustrate that we are not losing any information</span>

<span class="c1"># On the new image</span>
<span class="n">downsampler</span><span class="o">.</span><span class="n">newimage</span><span class="o">.</span><span class="n">getprofile</span><span class="p">(</span><span class="s1">&#39;Creep&#39;</span><span class="p">,</span> <span class="mf">32.8</span><span class="p">,</span> <span class="mf">40.8</span><span class="p">,</span> <span class="mf">60.</span><span class="p">,</span> <span class="mf">175.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>
<span class="n">downsampler</span><span class="o">.</span><span class="n">newimage</span><span class="o">.</span><span class="n">getprofile</span><span class="p">(</span><span class="s1">&#39;Locked&#39;</span><span class="p">,</span> <span class="mf">34.5</span><span class="p">,</span> <span class="mf">41.</span><span class="p">,</span> <span class="mf">200.</span><span class="p">,</span> <span class="mf">175.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">)</span>

<span class="c1"># On the original image</span>
<span class="n">downsampler</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">getprofile</span><span class="p">(</span><span class="s1">&#39;Creep&#39;</span><span class="p">,</span> <span class="mf">32.8</span><span class="p">,</span> <span class="mf">40.8</span><span class="p">,</span> <span class="mf">60.</span><span class="p">,</span> <span class="mf">175.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>
<span class="n">downsampler</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">getprofile</span><span class="p">(</span><span class="s1">&#39;Locked&#39;</span><span class="p">,</span> <span class="mf">34.5</span><span class="p">,</span> <span class="mf">41.</span><span class="p">,</span> <span class="mf">200.</span><span class="p">,</span> <span class="mf">175.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show them</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># First profile</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">profile</span> <span class="o">=</span> <span class="n">downsampler</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="s1">&#39;Creep&#39;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">profile</span><span class="p">[</span><span class="s1">&#39;Distance&#39;</span><span class="p">],</span> <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;LOS Velocity&#39;</span><span class="p">],</span> <span class="s1">&#39;.k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">profile</span> <span class="o">=</span> <span class="n">downsampler</span><span class="o">.</span><span class="n">newimage</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="s1">&#39;Creep&#39;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">profile</span><span class="p">[</span><span class="s1">&#39;Distance&#39;</span><span class="p">],</span> <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;LOS Velocity&#39;</span><span class="p">],</span> <span class="s1">&#39;.r&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;LOS Velocity (mm/yr)&#39;</span><span class="p">)</span>

<span class="c1"># Second one</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">profile</span> <span class="o">=</span> <span class="n">downsampler</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="s1">&#39;Locked&#39;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">profile</span><span class="p">[</span><span class="s1">&#39;Distance&#39;</span><span class="p">],</span> <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;LOS Velocity&#39;</span><span class="p">],</span> <span class="s1">&#39;.k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">profile</span> <span class="o">=</span> <span class="n">downsampler</span><span class="o">.</span><span class="n">newimage</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="s1">&#39;Locked&#39;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">profile</span><span class="p">[</span><span class="s1">&#39;Distance&#39;</span><span class="p">],</span> <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;LOS Velocity&#39;</span><span class="p">],</span> <span class="s1">&#39;.r&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;LOS Velocity (mm/yr)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance (km)&#39;</span><span class="p">)</span>

<span class="c1"># Show me</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInSAR_23_0.png" src="../_images/notebooks_tutoInSAR_23_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Of course all of this downsampling can be written down in two output files</span>
<span class="c1"># The file name is just the main name of the files. The file name will be with &#39;.txt&#39; extension.</span>
<span class="c1"># If rsp is True, then an additional file is written with the decimation pattern (the corners of the boxes). It has a &#39;.rsp&#39; extension.</span>

<span class="c1"># Uncomment to run</span>
<span class="c1">#downsampler.writeDownsampled2File(&#39;{}&#39;.format(rate.name), rsp=True)</span>
</pre></div>
</div>
</div>
</section>
<section id="Covariance-computing">
<h2>Covariance computing<a class="headerlink" href="#Covariance-computing" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We do not want to include the NaNs in the covariance calculation, so we first remove the NaNs from the object.</span>
<span class="c1"># Make a velocity object</span>
<span class="n">rate</span> <span class="o">=</span> <span class="n">insar</span><span class="p">(</span><span class="s1">&#39;Rate map T167&#39;</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="n">lat0</span><span class="p">)</span>

<span class="c1"># Read the binary data into the object</span>
<span class="c1"># Note that these arrays could be files</span>
<span class="n">rate</span><span class="o">.</span><span class="n">read_from_binary</span><span class="p">(</span><span class="n">velocity</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">remove_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zeros</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">incidence</span><span class="o">=</span><span class="n">inc</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">azi</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

<span class="c1"># Here, we remove the NaNs</span>
<span class="n">rate</span><span class="o">.</span><span class="n">checkNaNs</span><span class="p">()</span>

<span class="c1"># Here, we find the points that are more that 60 km away from the fault</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">rate</span><span class="o">.</span><span class="n">getDistance2Faults</span><span class="p">(</span><span class="n">naf</span><span class="p">)</span>

<span class="c1"># We set these to NaNs</span>
<span class="n">rate</span><span class="o">.</span><span class="n">vel</span><span class="p">[</span><span class="n">d</span><span class="o">&gt;</span><span class="mf">60.</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">rate</span><span class="o">.</span><span class="n">vel</span><span class="p">[</span><span class="n">d</span><span class="o">&lt;</span><span class="mf">1.</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="c1"># And we remove them</span>
<span class="n">rate</span><span class="o">.</span><span class="n">checkNaNs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initialize InSAR data set Rate map T167
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the covariance object</span>
<span class="n">covariance</span> <span class="o">=</span> <span class="n">imcov</span><span class="p">(</span><span class="s1">&#39;Rate map T167&#39;</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Keep only where we want to compute the covariance</span>
<span class="c1"># There is also a maskOut method that kicks out a region if needed</span>
<span class="n">covariance</span><span class="o">.</span><span class="n">maskIn</span><span class="p">([</span><span class="mf">33.5</span><span class="p">,</span> <span class="mf">34.5</span><span class="p">,</span> <span class="mf">39.9</span><span class="p">,</span> <span class="mf">40.7</span><span class="p">])</span>

<span class="c1"># Compute the covariance</span>
<span class="c1"># frac is the fraction of the image used to compute the covariance (an integer number will give you a fixed number of couple of points while a float &lt; 1 will give you a fraction of the</span>
<span class="c1"># total number of couple of points)</span>
<span class="c1"># every is the binning distance used to compute the covariance</span>
<span class="c1"># distmax is the max distance used to compute the covariance</span>
<span class="c1"># rampEst allows to estimate a ramp before computing the covariance</span>
<span class="n">covariance</span><span class="o">.</span><span class="n">computeCovariance</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">every</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">distmax</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span> <span class="n">rampEst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#covariance.computeCovariance(frac=1.0)</span>

<span class="c1"># Write to files. Uncomment to run</span>
<span class="c1"># covariance.write2file()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initialize InSAR covariance tools Rate map T167
Dealing with data set Rate map T167
     Zone of Interest: 33.5 &lt;= Lon &lt;= 34.5 || 39.9 &lt;= Lat &lt;= 40.7
Computing covariograms
Computing 1-D empirical semivariogram function for data set Rate map T167
Selecting 20000 random samples to estimate the covariance function
Estimated Orbital Plane: -0.004545294876808707xy + 20.51980559057633x + 2.392363044138502y + -10804.668783776162
Build the permutations
Digitize the histogram
Fitting Covariance functions
Dataset Rate map T167:
A prior values: Sill | Sigma | Lambda
                 2.419558 | 0.105810 | 4.146227
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            3     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  4.99781D-01    |proj g|=  9.48718D-01

At iterate    1    f=  3.69482D-01    |proj g|=  7.69231D-02

At iterate    2    f=  3.66712D-01    |proj g|=  4.58774D-02

At iterate    3    f=  3.63216D-01    |proj g|=  6.21714D-02

At iterate    4    f=  3.58668D-01    |proj g|=  1.02564D-01

At iterate    5    f=  3.58408D-01    |proj g|=  2.30769D-01

At iterate    6    f=  2.69978D-01    |proj g|=  7.17949D-01

At iterate    7    f=  2.63760D-01    |proj g|=  7.94872D-01

At iterate    8    f=  8.79436D-02    |proj g|=  3.58974D-01

At iterate    9    f=  7.97412D-02    |proj g|=  4.45059D-02

At iterate   10    f=  7.96112D-02    |proj g|=  5.12821D-02

At iterate   11    f=  7.95932D-02    |proj g|=  2.56410D-02

At iterate   12    f=  7.95120D-02    |proj g|=  6.42436D-03
Dataset Rate map T167:
     Sill   :  2.3957594064634273
     Sigma  :  1.43281660780602
     Lambda :  5.248109294597561

At iterate   13    f=  7.95076D-02    |proj g|=  6.41964D-03

At iterate   14    f=  7.95075D-02    |proj g|=  6.41960D-03

At iterate   15    f=  7.95075D-02    |proj g|=  2.56410D-02

At iterate   16    f=  7.88493D-02    |proj g|=  4.20747D-02

At iterate   17    f=  7.85113D-02    |proj g|=  7.69231D-02

At iterate   18    f=  7.84356D-02    |proj g|=  5.12820D-02

At iterate   19    f=  7.84348D-02    |proj g|=  7.69231D-02

At iterate   20    f=  7.78800D-02    |proj g|=  7.69231D-02

At iterate   21    f=  7.78733D-02    |proj g|=  7.69231D-02
  ys=-6.593E-07  -gs= 6.388E-06 BFGS update SKIPPED

At iterate   22    f=  7.78730D-02    |proj g|=  7.69231D-02
  ys=-1.371E-09  -gs= 3.224E-07 BFGS update SKIPPED

At iterate   23    f=  7.78730D-02    |proj g|=  1.01134D-01

At iterate   24    f=  7.78256D-02    |proj g|=  7.69231D-02
  ys=-1.922E-05  -gs= 3.796E-05 BFGS update SKIPPED

At iterate   25    f=  7.78253D-02    |proj g|=  7.69231D-02
  ys=-1.232E-09  -gs= 2.983E-07 BFGS update SKIPPED

At iterate   26    f=  7.78253D-02    |proj g|=  7.69231D-02

At iterate   27    f=  7.78251D-02    |proj g|=  1.02564D-01

At iterate   28    f=  7.73575D-02    |proj g|=  1.02564D-01

At iterate   29    f=  7.70956D-02    |proj g|=  1.28205D-01

At iterate   30    f=  7.70285D-02    |proj g|=  5.12821D-02

At iterate   31    f=  7.70242D-02    |proj g|=  7.69231D-02

At iterate   32    f=  7.70240D-02    |proj g|=  5.12821D-02

At iterate   33    f=  7.70238D-02    |proj g|=  5.12821D-02
  ys=-6.346E-10  -gs= 1.869E-07 BFGS update SKIPPED

At iterate   34    f=  7.70238D-02    |proj g|=  7.38714D-02
  ys=-5.402E-09  -gs= 1.246E-09 BFGS update SKIPPED

At iterate   35    f=  7.70238D-02    |proj g|=  7.68550D-02

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    3     35    184     35     6     0   7.686D-02   7.702D-02
  F =   7.7023843960406027E-002

CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show me the covariance</span>
<span class="n">covariance</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInSAR_28_0.png" src="../_images/notebooks_tutoInSAR_28_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># As you can see, there is some possible additional work to be done here as the shape of the covariance is not always a simple</span>
<span class="c1"># exponential decay. We have added the possibility to use a gaussian covariance, but this results in non-definite matrices.</span>
<span class="c1"># Some work is required here...</span>
</pre></div>
</div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">CSI</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../basictutorials.html">Basic Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CSIpublications.html">CSI Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classes.html">Classes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../basictutorials.html">Basic Tutorials</a><ul>
      <li>Previous: <a href="../basictutorials.html" title="previous chapter">Basic Tutorials</a></li>
      <li>Next: <a href="tutoInversionCreep.html" title="next chapter">Aseismic slip rate inversion</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Romain Jolivet.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/notebooks/tutoInSAR.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>