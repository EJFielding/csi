<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Aseismic slip rate inversion &#8212; CSI 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=62c01f10" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=f78ba3b0" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script src="../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=e637711f"></script>
    <script src="../_static/copybutton.js?v=56c01ce6"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="A tutorial for pressure sources in CSI" href="tutoPressureSource.html" />
    <link rel="prev" title="A tutorial for InSAR data in CSI" href="tutoInSAR.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Aseismic-slip-rate-inversion">
<h1>Aseismic slip rate inversion<a class="headerlink" href="#Aseismic-slip-rate-inversion" title="Link to this heading">¶</a></h1>
<p>In this notebook, we show some examples on how to compute the aseismic slip distribution along a creeping fault. This is a simple example using homogeneous elastic half space and no refined elastic structures. The InSAR data have already been downsampled and the GNSS data are already curated. More advanced things can be done, including stratified Green’s function computation, building the input files for external solvers, etc.</p>
<p>This example is a simpler version of what has been done to derive the slip distribution from Jolivet et al 2023 JGR.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#------------------------------------------------------------------</span>
<span class="c1">#------------------------------------------------------------------</span>
<span class="c1">#</span>
<span class="c1">#         Inverse for creep on the North Anatolian Fault</span>
<span class="c1">#</span>
<span class="c1">#------------------------------------------------------------------</span>
<span class="c1">#------------------------------------------------------------------</span>

<span class="c1"># Faults and Pressure source</span>
<span class="kn">import</span> <span class="nn">csi.TriangularPatches</span> <span class="k">as</span> <span class="nn">triangleflt</span>
<span class="kn">import</span> <span class="nn">csi.fault3D</span> <span class="k">as</span> <span class="nn">rectflt</span>
<span class="kn">import</span> <span class="nn">csi.Mogi</span> <span class="k">as</span> <span class="nn">mogi</span>

<span class="c1"># Data</span>
<span class="kn">import</span> <span class="nn">csi.insar</span> <span class="k">as</span> <span class="nn">insar</span>
<span class="kn">import</span> <span class="nn">csi.gps</span> <span class="k">as</span> <span class="nn">gps</span>

<span class="c1"># Tools</span>
<span class="kn">import</span> <span class="nn">csi.geodeticplot</span> <span class="k">as</span> <span class="nn">geoplt</span>
<span class="kn">import</span> <span class="nn">csi.multifaultsolve</span> <span class="k">as</span> <span class="nn">multiflt</span>
<span class="kn">import</span> <span class="nn">csi.transformation</span> <span class="k">as</span> <span class="nn">transform</span>

<span class="c1"># Colors</span>
<span class="kn">import</span> <span class="nn">cmcrameri.cm</span> <span class="k">as</span> <span class="nn">cm</span>

<span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">pickle</span><span class="o">,</span> <span class="nn">copy</span><span class="o">,</span> <span class="nn">h5py</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.interpolate</span> <span class="k">as</span> <span class="nn">sciint</span>

<span class="c1"># F*** off warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Some styling changes</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelweight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;x-large&#39;</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.titlesize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;xx-large&#39;</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.titleweight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span>

<span class="c1"># Reference</span>
<span class="n">lon0</span><span class="o">=</span><span class="mf">33.0</span>
<span class="n">lat0</span><span class="o">=</span><span class="mf">40.8</span>
</pre></div>
</div>
</div>
<section id="Building-the-faults">
<h2>Building the faults<a class="headerlink" href="#Building-the-faults" title="Link to this heading">¶</a></h2>
<p>In this section, we first build the fault objects using ready made geometries. There will be other notebooks to teach you how to do that.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the main NAF fault and its patches</span>
<span class="c1"># Its patches are read from a file and the slip is initialized</span>
<span class="n">naf</span> <span class="o">=</span> <span class="n">triangleflt</span><span class="p">(</span><span class="s1">&#39;Short North Anatolian Fault Final&#39;</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="n">lat0</span><span class="p">)</span>
<span class="n">naf</span><span class="o">.</span><span class="n">file2trace</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;DataAndModels/NAF.xy&#39;</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">naf</span><span class="o">.</span><span class="n">readPatchesFromFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;DataAndModels/Inversion/NAF.patches&#39;</span><span class="p">),</span>
                        <span class="n">readpatchindex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">donotreadslip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">naf</span><span class="o">.</span><span class="n">initializeslip</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span>

<span class="c1"># For later plotting</span>
<span class="n">naf</span><span class="o">.</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
<span class="n">naf</span><span class="o">.</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span>

<span class="c1"># The deep portion of the fault is a rectangular fault object</span>
<span class="n">deep</span> <span class="o">=</span> <span class="n">rectflt</span><span class="p">(</span><span class="s1">&#39;Deep NAF&#39;</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="n">lat0</span><span class="p">)</span>
<span class="n">deep</span><span class="o">.</span><span class="n">readPatchesFromFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;DataAndModels/Inversion/deepNAF.patches&#39;</span><span class="p">),</span>
                         <span class="n">readpatchindex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">donotreadslip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">deep</span><span class="o">.</span><span class="n">computeEquivRectangle</span><span class="p">()</span>
<span class="n">deep</span><span class="o">.</span><span class="n">initializeslip</span><span class="p">()</span>
<span class="n">deep</span><span class="o">.</span><span class="n">setTrace</span><span class="p">(</span><span class="n">delta_depth</span><span class="o">=</span><span class="mf">16.</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="c1"># The eastern portion of the fault is a rectangular fault object</span>
<span class="n">east</span> <span class="o">=</span> <span class="n">rectflt</span><span class="p">(</span><span class="s1">&#39;East NAF&#39;</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="n">lat0</span><span class="p">)</span>
<span class="n">east</span><span class="o">.</span><span class="n">readPatchesFromFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="s1">&#39;DataAndModels/Inversion/eastNAF.patches&#39;</span><span class="p">),</span>
                         <span class="n">readpatchindex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">donotreadslip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">east</span><span class="o">.</span><span class="n">computeEquivRectangle</span><span class="p">()</span>
<span class="n">east</span><span class="o">.</span><span class="n">initializeslip</span><span class="p">()</span>

<span class="c1"># The wesetrn portion of the fault is a rectangular fault object</span>
<span class="n">west</span> <span class="o">=</span> <span class="n">rectflt</span><span class="p">(</span><span class="s1">&#39;West NAF&#39;</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="n">lat0</span><span class="p">)</span>
<span class="n">west</span><span class="o">.</span><span class="n">readPatchesFromFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="s1">&#39;DataAndModels/Inversion/westNAF.patches&#39;</span><span class="p">),</span>
                         <span class="n">readpatchindex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">donotreadslip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">west</span><span class="o">.</span><span class="n">computeEquivRectangle</span><span class="p">()</span>
<span class="n">west</span><span class="o">.</span><span class="n">initializeslip</span><span class="p">()</span>

<span class="c1"># All faults are stored in a single list</span>
<span class="n">faults</span> <span class="o">=</span> <span class="p">[</span><span class="n">naf</span><span class="p">,</span> <span class="n">deep</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">west</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initializing fault Short North Anatolian Fault Final
---------------------------------
---------------------------------
Initializing fault Deep NAF
---------------------------------
---------------------------------
Initializing fault East NAF
---------------------------------
---------------------------------
Initializing fault West NAF
</pre></div></div>
</div>
</section>
<section id="Mogi-source">
<h2>Mogi source<a class="headerlink" href="#Mogi-source" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We create a Mogi source to account for the small subsidence in the Ismetpasa basin</span>
<span class="n">basin</span> <span class="o">=</span> <span class="n">mogi</span><span class="p">(</span><span class="s1">&#39;Ismetpasa basin&#39;</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="n">lat0</span><span class="p">)</span>
<span class="n">basin</span><span class="o">.</span><span class="n">createShape</span><span class="p">(</span><span class="mf">32.64</span><span class="p">,</span> <span class="mf">40.88</span><span class="p">,</span> <span class="mf">3000.</span><span class="p">,</span> <span class="mf">6000.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initializing pressure source Ismetpasa basin
</pre></div></div>
</div>
</section>
<section id="InSAR-velocity-maps">
<h2>InSAR velocity maps<a class="headerlink" href="#InSAR-velocity-maps" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we read the downsampled InSAR data. The use of dictionnary is my own choice and you can do otherwise.</span>
<span class="c1"># The data have already been downsampled and the covariances have been computed ahead as well. To see how that works, check the notebook tutoInSAR.ipynb</span>

<span class="c1"># SAR interferometry Data</span>
<span class="n">insarFiles</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;track 87&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;DataAndModels/Inversion/Rate_map_T87&#39;</span><span class="p">),</span>
              <span class="s1">&#39;track 65&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;DataAndModels/Inversion/Rate_map_T65&#39;</span><span class="p">),</span>
              <span class="s1">&#39;track 167&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;DataAndModels/Inversion/Rate_map_T167&#39;</span><span class="p">)}</span>
<span class="n">covFiles</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;track 87&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;DataAndModels/Inversion/Covariance_Sentinel-1_D87&#39;</span><span class="p">),</span>
            <span class="s1">&#39;track 65&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;DataAndModels/Inversion/Covariance_Sentinel-1_65&#39;</span><span class="p">),</span>
            <span class="s1">&#39;track 167&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;DataAndModels/Inversion/Covariance_Sentinel-1_167&#39;</span><span class="p">)}</span>

<span class="c1"># Covariances</span>
<span class="n">Covariances</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;track 87&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">covFiles</span><span class="p">[</span><span class="s1">&#39;track 87&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.cov&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Sigma&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                            <span class="s1">&#39;lambda&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">covFiles</span><span class="p">[</span><span class="s1">&#39;track 87&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.cov&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Lambda&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">covFiles</span><span class="p">[</span><span class="s1">&#39;track 87&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.std&#39;</span><span class="p">))},</span>
               <span class="s1">&#39;track 65&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">covFiles</span><span class="p">[</span><span class="s1">&#39;track 65&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.cov&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Sigma&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                            <span class="s1">&#39;lambda&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">covFiles</span><span class="p">[</span><span class="s1">&#39;track 65&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.cov&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Lambda&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">covFiles</span><span class="p">[</span><span class="s1">&#39;track 65&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.std&#39;</span><span class="p">))},</span>
               <span class="s1">&#39;track 167&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">covFiles</span><span class="p">[</span><span class="s1">&#39;track 167&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.cov&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Sigma&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                             <span class="s1">&#39;lambda&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">covFiles</span><span class="p">[</span><span class="s1">&#39;track 167&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.cov&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Lambda&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                             <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">covFiles</span><span class="p">[</span><span class="s1">&#39;track 167&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.std&#39;</span><span class="p">))}}</span>

<span class="c1"># I create a holder to store the InSAR data</span>
<span class="n">InSARs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># I iterate over the available data</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">insarFiles</span><span class="p">:</span>

    <span class="c1"># Get the file names</span>
    <span class="n">dataPath</span> <span class="o">=</span> <span class="n">insarFiles</span><span class="p">[</span><span class="n">data</span><span class="p">]</span>

    <span class="c1"># Create an InSAR object</span>
    <span class="n">sar</span> <span class="o">=</span> <span class="n">insar</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="n">lat0</span><span class="p">)</span>

    <span class="c1"># Read the downsampled data (varres is the old name of the downsampler originally written in Matlab by Mark Simons @CalTech</span>
    <span class="n">sar</span><span class="o">.</span><span class="n">read_from_varres</span><span class="p">(</span><span class="n">dataPath</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Already in mm so factor = 1</span>

    <span class="c1"># Build the data covariance matrix from the info we collected above</span>
    <span class="n">sar</span><span class="o">.</span><span class="n">buildCd</span><span class="p">(</span><span class="n">Covariances</span><span class="p">[</span><span class="n">data</span><span class="p">][</span><span class="s1">&#39;sigma&#39;</span><span class="p">],</span> <span class="n">Covariances</span><span class="p">[</span><span class="n">data</span><span class="p">][</span><span class="s1">&#39;lambda&#39;</span><span class="p">])</span>

    <span class="c1"># Add the actual variance on the diagonal</span>
    <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">sar</span><span class="o">.</span><span class="n">Cd</span><span class="p">,</span> <span class="n">Covariances</span><span class="p">[</span><span class="n">data</span><span class="p">][</span><span class="s1">&#39;std&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Store this InSAR object</span>
    <span class="n">InSARs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sar</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initialize InSAR data set track 87
Read from file /Users/romainjolivet/MYBIN/csi/notebooks/DataAndModels/Inversion/Rate_map_T87 into data set track 87
---------------------------------
---------------------------------
Initialize InSAR data set track 65
Read from file /Users/romainjolivet/MYBIN/csi/notebooks/DataAndModels/Inversion/Rate_map_T65 into data set track 65
---------------------------------
---------------------------------
Initialize InSAR data set track 167
Read from file /Users/romainjolivet/MYBIN/csi/notebooks/DataAndModels/Inversion/Rate_map_T167 into data set track 167
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show me</span>
<span class="k">for</span> <span class="n">sar</span> <span class="ow">in</span> <span class="n">InSARs</span><span class="p">:</span>
    <span class="n">sar</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plotType</span><span class="o">=</span><span class="s1">&#39;decimate&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span> <span class="n">edgewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
             <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma</span><span class="p">,</span> <span class="n">cbaxis</span><span class="o">=</span><span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;LOS velocity (mm/yr)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_8_0.png" src="../_images/notebooks_tutoInversionCreep_8_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_8_1.png" src="../_images/notebooks_tutoInversionCreep_8_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_8_2.png" src="../_images/notebooks_tutoInversionCreep_8_2.png" />
</div>
</div>
</section>
<section id="GPS-velocities">
<h2>GPS velocities<a class="headerlink" href="#GPS-velocities" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We read the GNSS velocities from a curated file</span>

<span class="c1"># Create an object</span>
<span class="n">ismenet</span> <span class="o">=</span> <span class="n">gps</span><span class="p">(</span><span class="s1">&#39;Ismenet Velocity&#39;</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="n">lat0</span><span class="p">)</span>

<span class="c1"># Use the read_from_enu method (there is other methods for other formats and if your favorite format is missing, please add it)</span>
<span class="n">ismenet</span><span class="o">.</span><span class="n">read_from_enu</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;DataAndModels/Inversion/GNSS.enu&#39;</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># I don&#39;t want to use the vertical component</span>
<span class="n">ismenet</span><span class="o">.</span><span class="n">vel_enu</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="c1"># Build the data covariance matrix</span>
<span class="n">ismenet</span><span class="o">.</span><span class="n">buildCd</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initialize GPS array Ismenet Velocity
Read data from file /Users/romainjolivet/MYBIN/csi/notebooks/DataAndModels/Inversion/GNSS.enu into data set Ismenet Velocity
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show me</span>
<span class="n">ismenet</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="mf">25.</span><span class="p">,</span> <span class="n">faults</span><span class="o">=</span><span class="p">[</span><span class="n">naf</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_11_0.png" src="../_images/notebooks_tutoInversionCreep_11_0.png" />
</div>
</div>
</section>
<section id="Building-the-Green's-functions">
<h2>Building the Green’s functions<a class="headerlink" href="#Building-the-Green's-functions" title="Link to this heading">¶</a></h2>
<p>In this example, we have four faults. One of them, the naf object, has triangular patches. We use the Meade solution for triangular dislocation in an elastic halfspace. The three other ones are made of rectangular patches and we use the classic Okada formulation that is implemented in Okada4py (to be installed separately from csi. Go check <a class="reference external" href="https://github.com/jolivetr/okada4py">https://github.com/jolivetr/okada4py</a>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build the GFs for each dataset and each fault independently</span>
<span class="c1"># I set vertical to False since I don&#39;t want to use the vertical component of the GNSS data</span>

<span class="c1"># InSAR data</span>
<span class="k">for</span> <span class="n">sar</span> <span class="ow">in</span> <span class="n">InSARs</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">fault</span> <span class="ow">in</span> <span class="n">faults</span><span class="p">:</span>
        <span class="n">fault</span><span class="o">.</span><span class="n">buildGFs</span><span class="p">(</span><span class="n">sar</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># By default, left-lateral is positive for the triangular patch and I want to use NNLS at some point, so I need to change the sign</span>
        <span class="n">fault</span><span class="o">.</span><span class="n">G</span><span class="p">[</span><span class="n">sar</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.</span>

<span class="c1"># GNSS data</span>
<span class="k">for</span> <span class="n">gnss</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ismenet</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">fault</span> <span class="ow">in</span> <span class="n">faults</span><span class="p">:</span>
        <span class="n">fault</span><span class="o">.</span><span class="n">buildGFs</span><span class="p">(</span><span class="n">gnss</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># By default, left-lateral is positive and I want to use NNLS at some point, so I need to change the sign</span>
        <span class="n">fault</span><span class="o">.</span><span class="n">G</span><span class="p">[</span><span class="n">gnss</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.</span>

<span class="c1"># Pressure drop is negative in the model but we want to have it positive to be able to use NNLS</span>
<span class="k">for</span> <span class="n">sar</span> <span class="ow">in</span> <span class="n">InSARs</span><span class="p">:</span> <span class="n">basin</span><span class="o">.</span><span class="n">buildGFs</span><span class="p">(</span><span class="n">sar</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">gnss</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ismenet</span><span class="p">]:</span> <span class="n">basin</span><span class="o">.</span><span class="n">buildGFs</span><span class="p">(</span><span class="n">gnss</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">InSARs</span><span class="o">+</span><span class="p">[</span><span class="n">ismenet</span><span class="p">]:</span> <span class="n">basin</span><span class="o">.</span><span class="n">G</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1e6</span> <span class="c1"># Pressure will be in MPa</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Greens functions computation method: Meade
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
track 87 of type insar in a homogeneous half-space
 Patch: 1292 / 1292
Greens functions computation method: Okada
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
track 87 of type insar in a homogeneous half-space
 Patch: 5 / 5
Greens functions computation method: Okada
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
track 87 of type insar in a homogeneous half-space
 Patch: 1 / 1
Greens functions computation method: Okada
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
track 87 of type insar in a homogeneous half-space
 Patch: 1 / 1
Greens functions computation method: Meade
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
track 65 of type insar in a homogeneous half-space
 Patch: 1292 / 1292
Greens functions computation method: Okada
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
track 65 of type insar in a homogeneous half-space
 Patch: 5 / 5
Greens functions computation method: Okada
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
track 65 of type insar in a homogeneous half-space
 Patch: 1 / 1
Greens functions computation method: Okada
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
track 65 of type insar in a homogeneous half-space
 Patch: 1 / 1
Greens functions computation method: Meade
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
track 167 of type insar in a homogeneous half-space
 Patch: 1292 / 1292
Greens functions computation method: Okada
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
track 167 of type insar in a homogeneous half-space
 Patch: 5 / 5
Greens functions computation method: Okada
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
track 167 of type insar in a homogeneous half-space
 Patch: 1 / 1
Greens functions computation method: Okada
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
track 167 of type insar in a homogeneous half-space
 Patch: 1 / 1
Greens functions computation method: Meade
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
Ismenet Velocity of type gps in a homogeneous half-space
 Patch: 1292 / 1292
Greens functions computation method: Okada
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
Ismenet Velocity of type gps in a homogeneous half-space
 Patch: 5 / 5
Greens functions computation method: Okada
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
Ismenet Velocity of type gps in a homogeneous half-space
 Patch: 1 / 1
Greens functions computation method: Okada
---------------------------------
---------------------------------
Building Green&#39;s functions for the data set
Ismenet Velocity of type gps in a homogeneous half-space
 Patch: 1 / 1
Greens functions computation method: volume
---------------------------------
---------------------------------
Building pressure source Green&#39;s functions for the data set
track 87 of type insar in a homogeneous half-space
Converting to pressure for Mogi Green&#39;s function calculations

Greens functions computation method: volume
---------------------------------
---------------------------------
Building pressure source Green&#39;s functions for the data set
track 65 of type insar in a homogeneous half-space
Converting to pressure for Mogi Green&#39;s function calculations

Greens functions computation method: volume
---------------------------------
---------------------------------
Building pressure source Green&#39;s functions for the data set
track 167 of type insar in a homogeneous half-space
Converting to pressure for Mogi Green&#39;s function calculations

Greens functions computation method: volume
---------------------------------
---------------------------------
Building pressure source Green&#39;s functions for the data set
Ismenet Velocity of type gps in a homogeneous half-space
Converting to pressure for Mogi Green&#39;s function calculations

</pre></div></div>
</div>
</section>
<section id="Creating-a-transformation-object">
<h2>Creating a transformation object<a class="headerlink" href="#Creating-a-transformation-object" title="Link to this heading">¶</a></h2>
<p>In an inversion, the fault object does not really care about reference frames. Furthermore, InSAR is a relative measurement. Therefore, you need to have some degree of freedom between the different datasets so they fall in the same reference frame. If you have carefully done that ahead, don’t use a transformation object. However, as soon as you use InSAR, you should…</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s make a single data list</span>
<span class="n">Datas</span> <span class="o">=</span> <span class="n">InSARs</span> <span class="o">+</span> <span class="p">[</span><span class="n">ismenet</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a transformation object</span>
<span class="n">trans</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="s1">&#39;Reference frame Corrections&#39;</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="n">lat0</span><span class="p">)</span>

<span class="c1"># Build the GFs for the transformations. Here, we will solve for a bilinear plane in each InSAR velocity map and estimate a translation in the GNSS data</span>
<span class="c1"># Other options are possible, such as a &#39;full&#39; Helmert transform, or a simple &#39;translation&#39; or &#39;rotation&#39; in the GNSS data. For InSAR, there is only 2 options (1 and 3)</span>
<span class="n">trans</span><span class="o">.</span><span class="n">buildGFs</span><span class="p">(</span><span class="n">Datas</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;translation&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initializing transformation Reference frame Corrections
</pre></div></div>
</div>
</section>
<section id="Assembling-the-data">
<h2>Assembling the data<a class="headerlink" href="#Assembling-the-data" title="Link to this heading">¶</a></h2>
<p>Different elements must be assembled together to enter in the inversion. Assembling means concatenating the various data vectors and GFs and covariance matrices before actually inverting the problem.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assemble the GFs and the data covariance matrices for the fault objects</span>
<span class="c1"># Here, I only use the strike slip component and discard the dipslip</span>
<span class="k">for</span> <span class="n">fault</span> <span class="ow">in</span> <span class="n">faults</span><span class="p">:</span>
    <span class="n">fault</span><span class="o">.</span><span class="n">assembleGFs</span><span class="p">(</span><span class="n">Datas</span><span class="p">,</span> <span class="n">slipdir</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
    <span class="n">fault</span><span class="o">.</span><span class="n">assembled</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
    <span class="n">fault</span><span class="o">.</span><span class="n">assembleCd</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>

<span class="c1"># Same for the pressure source</span>
<span class="n">basin</span><span class="o">.</span><span class="n">assembleGFs</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
<span class="n">basin</span><span class="o">.</span><span class="n">assembled</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
<span class="n">basin</span><span class="o">.</span><span class="n">assembleCd</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>

<span class="c1"># Same for the transformation</span>
<span class="n">trans</span><span class="o">.</span><span class="n">assembleGFs</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
<span class="n">trans</span><span class="o">.</span><span class="n">assembled</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
<span class="n">trans</span><span class="o">.</span><span class="n">assembleCd</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Assembling G for fault Short North Anatolian Fault Final
Dealing with track 87 of type insar
Dealing with track 65 of type insar
Dealing with track 167 of type insar
Dealing with Ismenet Velocity of type gps
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling G for fault Deep NAF
Dealing with track 87 of type insar
Dealing with track 65 of type insar
Dealing with track 167 of type insar
Dealing with Ismenet Velocity of type gps
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling G for fault East NAF
Dealing with track 87 of type insar
Dealing with track 65 of type insar
Dealing with track 167 of type insar
Dealing with Ismenet Velocity of type gps
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling G for fault West NAF
Dealing with track 87 of type insar
Dealing with track 65 of type insar
Dealing with track 167 of type insar
Dealing with Ismenet Velocity of type gps
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling G for pressure source Ismetpasa basin
Dealing with track 87 of type insar
(1341, 1) (1341,)
Dealing with track 65 of type insar
(770, 1) (770,)
Dealing with track 167 of type insar
(1365, 1) (1365,)
Dealing with Ismenet Velocity of type gps
(78, 1) (78, 1)
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling G for transformation Reference frame Corrections
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
</pre></div></div>
</div>
</section>
<section id="Solver">
<h2>Solver<a class="headerlink" href="#Solver" title="Link to this heading">¶</a></h2>
<p>This is where the action is. We will make different attempts at getting an acceptable solution.</p>
<section id="Regularization">
<h3>Regularization<a class="headerlink" href="#Regularization" title="Link to this heading">¶</a></h3>
<p>In CSI, there is no fancy regularization scheme. Basically, we can use - buildCm which builds a Cm matrix based on the approach of Radiguet et al 2010 (exponential decay of the model covariance as a function of the distance between pacthes) - buildCmXY which is the same but with different distances along horizontal and vertical directions - buildCmGaussian which builds a diagonal Cm matrix.</p>
<p>Currently, there is no Laplacian smoothing or norm damping although one can show equivalence between the regularizations we have implemented and these formers. I do not use any regularization when using AlTar, the Bayesian sampler, so this is really not my priority. Now, if you feel like implementing new ones, be my guest!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Model covariance matrix for the naf. We use different characteristic distances along the horizontal and vertical directions</span>
<span class="n">naf</span><span class="o">.</span><span class="n">buildCmXY</span><span class="p">(</span><span class="mf">20.</span><span class="p">,</span> <span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">))</span>

<span class="c1"># For the deep, west and east faults, we use a diagonal model covariance matrix</span>
<span class="n">west</span><span class="o">.</span><span class="n">buildCmGaussian</span><span class="p">([</span><span class="mf">.01</span><span class="p">])</span>
<span class="n">east</span><span class="o">.</span><span class="n">buildCmGaussian</span><span class="p">([</span><span class="mf">.01</span><span class="p">])</span>
<span class="n">deep</span><span class="o">.</span><span class="n">buildCmGaussian</span><span class="p">([</span><span class="mf">100.</span><span class="p">])</span>

<span class="c1"># Same for trans and the Mogi pressure source</span>
<span class="n">trans</span><span class="o">.</span><span class="n">buildCm</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
<span class="n">basin</span><span class="o">.</span><span class="n">buildCm</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Assembling the Cm matrix
Sigma = 20.0
Lambda = (10.0, 1.0)
Lambda0 = 0.2722630725042683
---------------------------------
---------------------------------
Assembling the Cm matrix
</pre></div></div>
</div>
</section>
<section id="First-attempt">
<h3>First attempt<a class="headerlink" href="#First-attempt" title="Link to this heading">¶</a></h3>
<p>Generalized least squares withtout any other constraints than those implemented in the data and model covariances. The solution is the maximum of the posterior PDF which is a Gaussian distribution assuming Gaussian priors and likelihood.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prepare solver</span>
<span class="n">slv</span> <span class="o">=</span> <span class="n">multiflt</span><span class="p">(</span><span class="s1">&#39;NAF slip rate&#39;</span><span class="p">,</span> <span class="n">faults</span><span class="o">+</span><span class="p">[</span><span class="n">basin</span><span class="p">,</span> <span class="n">trans</span><span class="p">])</span>
<span class="n">slv</span><span class="o">.</span><span class="n">assembleGFs</span><span class="p">()</span>
<span class="n">slv</span><span class="o">.</span><span class="n">assembleCm</span><span class="p">()</span>

<span class="c1"># Solve</span>
<span class="n">slv</span><span class="o">.</span><span class="n">GeneralizedLeastSquareSoln</span><span class="p">()</span>

<span class="c1"># Distribute results</span>
<span class="n">slv</span><span class="o">.</span><span class="n">distributem</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Basin pressure drop: </span><span class="si">{}</span><span class="s1"> MPa&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">basin</span><span class="o">.</span><span class="n">deltapressure</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initializing solver object
Not a fault detected
Number of data: 3554
Number of parameters: 1305
Parameter Description ----------------------------------
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
Short North Anatolian Fault Final||   0 - 1292 ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
Deep NAF                      ||1292 - 1297 ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
East NAF                      ||1297 - 1298 ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
West NAF                      ||1298 - 1299 ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
Ismetpasa basin               ||None        ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
Reference frame Corrections   ||None        ||None        ||None        ||None        ||1300 - 1305
---------------------------------
---------------------------------
Computing the Generalized Inverse
Computing the inverse of the model covariance
Computing the inverse of the data covariance
Computing m_post
Basin pressure drop: 6.970477384051452 MPa
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make a plot</span>

<span class="c1"># Plot the whole thing</span>
<span class="n">gp</span> <span class="o">=</span> <span class="n">geoplt</span><span class="p">(</span><span class="mf">31.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">35.</span><span class="p">,</span> <span class="mf">42.</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">)))</span>

<span class="c1"># Plot the faults</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">naf</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">deep</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">east</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">west</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>

<span class="c1"># Set views</span>
<span class="n">gp</span><span class="o">.</span><span class="n">setzaxis</span><span class="p">(</span><span class="mf">30.</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">280.</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">))</span>
<span class="n">gp</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">showFig</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fault&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_24_0.png" src="../_images/notebooks_tutoInversionCreep_24_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This plot is not very nice. Therefore, we will modify the patches we have in the deep and east and west objects to make them nicer.</span>
<span class="c1"># CSI includes methods to change the shape of patches but it is simpler to read again new geometries (and we do not calculate the GFs again) so the prediction is based on the large faults but the plot is nicer.</span>
<span class="c1"># We will also change the colormap to a more appropriate one and customize everything.</span>

<span class="n">deep</span><span class="o">.</span><span class="n">readPatchesFromFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;DataAndModels/Inversion/deepNAF.plotpatches&#39;</span><span class="p">),</span>
                         <span class="n">donotreadslip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">readpatchindex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">east</span><span class="o">.</span><span class="n">readPatchesFromFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;DataAndModels/Inversion/eastNAF.plotpatches&#39;</span><span class="p">),</span>
                         <span class="n">donotreadslip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">readpatchindex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">west</span><span class="o">.</span><span class="n">readPatchesFromFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;DataAndModels/Inversion/westNAF.plotpatches&#39;</span><span class="p">),</span>
                         <span class="n">donotreadslip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">readpatchindex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">slv</span><span class="o">.</span><span class="n">distributem</span><span class="p">()</span>

<span class="c1"># Plot the whole thing</span>
<span class="n">gp</span> <span class="o">=</span> <span class="n">geoplt</span><span class="p">(</span><span class="mf">31.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">35.5</span><span class="p">,</span> <span class="mf">42.</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">)))</span>

<span class="c1"># Plot the faults</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">naf</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma_r</span><span class="p">,</span>
                <span class="n">cbaxis</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;Slip rate (mm/yr)&#39;</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">deep</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma_r</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">east</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma_r</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">west</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma_r</span><span class="p">)</span>

<span class="c1"># Set views</span>
<span class="n">gp</span><span class="o">.</span><span class="n">setzaxis</span><span class="p">(</span><span class="mf">30.</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">280.</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">))</span>
<span class="n">gp</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">showFig</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fault&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_25_0.png" src="../_images/notebooks_tutoInversionCreep_25_0.png" />
</div>
</div>
</section>
<section id="Second-attempt">
<h3>Second attempt<a class="headerlink" href="#Second-attempt" title="Link to this heading">¶</a></h3>
<p>We now use the NNLS implementation (i.e. non-negative least squares).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For safety reasons, we re-assemble everyhting</span>
<span class="k">for</span> <span class="n">fault</span> <span class="ow">in</span> <span class="n">faults</span><span class="p">:</span>
    <span class="n">fault</span><span class="o">.</span><span class="n">assembleGFs</span><span class="p">(</span><span class="n">Datas</span><span class="p">,</span> <span class="n">slipdir</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
    <span class="n">fault</span><span class="o">.</span><span class="n">assembled</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
    <span class="n">fault</span><span class="o">.</span><span class="n">assembleCd</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>

<span class="c1"># Same for the pressure source</span>
<span class="n">basin</span><span class="o">.</span><span class="n">assembleGFs</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
<span class="n">basin</span><span class="o">.</span><span class="n">assembled</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
<span class="n">basin</span><span class="o">.</span><span class="n">assembleCd</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>

<span class="c1"># Same for the transformation</span>
<span class="n">trans</span><span class="o">.</span><span class="n">assembleGFs</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
<span class="n">trans</span><span class="o">.</span><span class="n">assembled</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
<span class="n">trans</span><span class="o">.</span><span class="n">assembleCd</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Assembling G for fault Short North Anatolian Fault Final
Dealing with track 87 of type insar
Dealing with track 65 of type insar
Dealing with track 167 of type insar
Dealing with Ismenet Velocity of type gps
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling G for fault Deep NAF
Dealing with track 87 of type insar
Dealing with track 65 of type insar
Dealing with track 167 of type insar
Dealing with Ismenet Velocity of type gps
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling G for fault East NAF
Dealing with track 87 of type insar
Dealing with track 65 of type insar
Dealing with track 167 of type insar
Dealing with Ismenet Velocity of type gps
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling G for fault West NAF
Dealing with track 87 of type insar
Dealing with track 65 of type insar
Dealing with track 167 of type insar
Dealing with Ismenet Velocity of type gps
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling G for pressure source Ismetpasa basin
Dealing with track 87 of type insar
(1341, 1) (1341,)
Dealing with track 65 of type insar
(770, 1) (770,)
Dealing with track 167 of type insar
(1365, 1) (1365,)
Dealing with Ismenet Velocity of type gps
(78, 1) (78, 1)
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling G for transformation Reference frame Corrections
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># And we rebuild the model covariances</span>
<span class="c1"># Model covariance matrix for the naf. We use different characteristic distances along the horizontal and vertical directions</span>
<span class="n">naf</span><span class="o">.</span><span class="n">buildCmXY</span><span class="p">(</span><span class="mf">20.</span><span class="p">,</span> <span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">))</span>

<span class="c1"># For the deep, west and east faults, we use a diagonal model covariance matrix</span>
<span class="n">west</span><span class="o">.</span><span class="n">buildCmGaussian</span><span class="p">([</span><span class="mf">.01</span><span class="p">])</span>
<span class="n">east</span><span class="o">.</span><span class="n">buildCmGaussian</span><span class="p">([</span><span class="mf">.01</span><span class="p">])</span>
<span class="n">deep</span><span class="o">.</span><span class="n">buildCmGaussian</span><span class="p">([</span><span class="mf">100.</span><span class="p">])</span>

<span class="c1"># Same for trans and the Mogi pressure source</span>
<span class="n">trans</span><span class="o">.</span><span class="n">buildCm</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
<span class="n">basin</span><span class="o">.</span><span class="n">buildCm</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Assembling the Cm matrix
Sigma = 20.0
Lambda = (10.0, 1.0)
Lambda0 = 0.2722630725042683
---------------------------------
---------------------------------
Assembling the Cm matrix
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prepare solver</span>
<span class="n">slv</span> <span class="o">=</span> <span class="n">multiflt</span><span class="p">(</span><span class="s1">&#39;NAF slip rate&#39;</span><span class="p">,</span> <span class="n">faults</span><span class="o">+</span><span class="p">[</span><span class="n">basin</span><span class="p">,</span> <span class="n">trans</span><span class="p">])</span>
<span class="n">slv</span><span class="o">.</span><span class="n">assembleGFs</span><span class="p">()</span>
<span class="n">slv</span><span class="o">.</span><span class="n">assembleCm</span><span class="p">()</span>

<span class="c1"># prior model</span>
<span class="n">mprior</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">slv</span><span class="o">.</span><span class="n">Np</span><span class="p">,))</span>

<span class="c1"># Solve</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">slv</span><span class="o">.</span><span class="n">paramTypes</span><span class="p">)</span> <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Reference frame Corrections&#39;</span><span class="p">]</span>
<span class="n">mprior</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">100.</span>
<span class="n">slv</span><span class="o">.</span><span class="n">ConstrainedLeastSquareSoln</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;nnls&#39;</span><span class="p">,</span> <span class="n">mprior</span><span class="o">=</span><span class="n">mprior</span><span class="p">)</span>

<span class="c1"># Distribute results</span>
<span class="n">slv</span><span class="o">.</span><span class="n">distributem</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Basin pressure drop: </span><span class="si">{}</span><span class="s1"> MPa&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">basin</span><span class="o">.</span><span class="n">deltapressure</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initializing solver object
Not a fault detected
Number of data: 3554
Number of parameters: 1305
Parameter Description ----------------------------------
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
Short North Anatolian Fault Final||   0 - 1292 ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
Deep NAF                      ||1292 - 1297 ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
East NAF                      ||1297 - 1298 ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
West NAF                      ||1298 - 1299 ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
Ismetpasa basin               ||None        ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
Reference frame Corrections   ||None        ||None        ||None        ||None        ||1300 - 1305
---------------------------------
---------------------------------
Computing the Constrained least squares solution
Final data space size: 3554
Final model space size: 1305
Computing the inverse of the model covariance
Computing the inverse of the data covariance
Performing non-negative least squares
Basin pressure drop: 6.843731969706828 MPa
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show me</span>

<span class="c1"># Create a figure</span>
<span class="n">gp</span> <span class="o">=</span> <span class="n">geoplt</span><span class="p">(</span><span class="mf">31.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">35.5</span><span class="p">,</span> <span class="mf">42.</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">)))</span>

<span class="c1"># Plot the faults</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">naf</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma_r</span><span class="p">,</span>
                <span class="n">cbaxis</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;Slip rate (mm/yr)&#39;</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">deep</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma_r</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">east</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma_r</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">west</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma_r</span><span class="p">)</span>

<span class="c1"># Set views</span>
<span class="n">gp</span><span class="o">.</span><span class="n">setzaxis</span><span class="p">(</span><span class="mf">30.</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">280.</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">))</span>
<span class="n">gp</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">showFig</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fault&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_30_0.png" src="../_images/notebooks_tutoInversionCreep_30_0.png" />
</div>
</div>
</section>
<section id="Third-attempt">
<h3>Third attempt<a class="headerlink" href="#Third-attempt" title="Link to this heading">¶</a></h3>
<p>Now we will be smarter. We want all patches at the bottom of the fault to slip at the same rate.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For safety reasons, we re-assemble everyhting</span>
<span class="k">for</span> <span class="n">fault</span> <span class="ow">in</span> <span class="n">faults</span><span class="p">:</span>
    <span class="n">fault</span><span class="o">.</span><span class="n">assembleGFs</span><span class="p">(</span><span class="n">Datas</span><span class="p">,</span> <span class="n">slipdir</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
    <span class="n">fault</span><span class="o">.</span><span class="n">assembled</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
    <span class="n">fault</span><span class="o">.</span><span class="n">assembleCd</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>

<span class="c1"># Same for the pressure source</span>
<span class="n">basin</span><span class="o">.</span><span class="n">assembleGFs</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
<span class="n">basin</span><span class="o">.</span><span class="n">assembled</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
<span class="n">basin</span><span class="o">.</span><span class="n">assembleCd</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>

<span class="c1"># Same for the transformation</span>
<span class="n">trans</span><span class="o">.</span><span class="n">assembleGFs</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
<span class="n">trans</span><span class="o">.</span><span class="n">assembled</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>
<span class="n">trans</span><span class="o">.</span><span class="n">assembleCd</span><span class="p">(</span><span class="n">Datas</span><span class="p">)</span>

<span class="c1"># And we rebuild the model covariances</span>
<span class="c1"># Model covariance matrix for the naf. We use different characteristic distances along the horizontal and vertical directions</span>
<span class="n">naf</span><span class="o">.</span><span class="n">buildCmXY</span><span class="p">(</span><span class="mf">20.</span><span class="p">,</span> <span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">))</span>

<span class="c1"># For the deep, west and east faults, we use a diagonal model covariance matrix</span>
<span class="n">west</span><span class="o">.</span><span class="n">buildCmGaussian</span><span class="p">([</span><span class="mf">.01</span><span class="p">])</span>
<span class="n">east</span><span class="o">.</span><span class="n">buildCmGaussian</span><span class="p">([</span><span class="mf">.01</span><span class="p">])</span>
<span class="n">deep</span><span class="o">.</span><span class="n">buildCmGaussian</span><span class="p">([</span><span class="mf">100.</span><span class="p">])</span>

<span class="c1"># Same for trans and the Mogi pressure source</span>
<span class="n">trans</span><span class="o">.</span><span class="n">buildCm</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
<span class="n">basin</span><span class="o">.</span><span class="n">buildCm</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Assembling G for fault Short North Anatolian Fault Final
Dealing with track 87 of type insar
Dealing with track 65 of type insar
Dealing with track 167 of type insar
Dealing with Ismenet Velocity of type gps
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling G for fault Deep NAF
Dealing with track 87 of type insar
Dealing with track 65 of type insar
Dealing with track 167 of type insar
Dealing with Ismenet Velocity of type gps
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling G for fault East NAF
Dealing with track 87 of type insar
Dealing with track 65 of type insar
Dealing with track 167 of type insar
Dealing with Ismenet Velocity of type gps
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling G for fault West NAF
Dealing with track 87 of type insar
Dealing with track 65 of type insar
Dealing with track 167 of type insar
Dealing with Ismenet Velocity of type gps
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling G for pressure source Ismetpasa basin
Dealing with track 87 of type insar
(1341, 1) (1341,)
Dealing with track 65 of type insar
(770, 1) (770,)
Dealing with track 167 of type insar
(1365, 1) (1365,)
Dealing with Ismenet Velocity of type gps
(78, 1) (78, 1)
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling G for transformation Reference frame Corrections
---------------------------------
---------------------------------
Assembling d vector
Dealing with data track 87
Dealing with data track 65
Dealing with data track 167
Dealing with data Ismenet Velocity
---------------------------------
---------------------------------
Assembling the Cm matrix
Sigma = 20.0
Lambda = (10.0, 1.0)
Lambda0 = 0.2722630725042683
---------------------------------
---------------------------------
Assembling the Cm matrix
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prepare solver</span>
<span class="n">slv</span> <span class="o">=</span> <span class="n">multiflt</span><span class="p">(</span><span class="s1">&#39;NAF slip rate&#39;</span><span class="p">,</span> <span class="n">faults</span><span class="o">+</span><span class="p">[</span><span class="n">basin</span><span class="p">,</span> <span class="n">trans</span><span class="p">])</span>
<span class="n">slv</span><span class="o">.</span><span class="n">assembleGFs</span><span class="p">()</span>
<span class="n">slv</span><span class="o">.</span><span class="n">assembleCm</span><span class="p">()</span>

<span class="c1"># Strong constraint to have linked parameters. Here, we build a list of the indexes of the parameters that we want to force being equal</span>
<span class="n">ss</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">slv</span><span class="o">.</span><span class="n">paramDescription</span><span class="p">[</span><span class="n">deep</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;Strike Slip&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="n">s</span><span class="o">!=</span><span class="s1">&#39;-&#39;</span><span class="p">]</span>

<span class="c1"># Equalize Parameters: Here, the equalizeParams methode simply sums the GFs of the parameters indicated by their indexes in ss to make it a single parameter</span>
<span class="n">slv</span><span class="o">.</span><span class="n">equalizeParams</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ss</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ss</span><span class="p">[</span><span class="mi">1</span><span class="p">])],</span> <span class="n">Cm</span><span class="o">=</span><span class="p">[</span><span class="mf">100.</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ss</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ss</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>

<span class="c1"># This describes the new structure of the model space</span>
<span class="n">slv</span><span class="o">.</span><span class="n">describeParams</span><span class="p">(</span><span class="n">redo</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># mprior</span>
<span class="n">mprior</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">slv</span><span class="o">.</span><span class="n">Np</span><span class="p">,))</span>

<span class="c1"># Solve nnls: Since we use nnls, we provide a negative prior for the paraeteres that are not necessarily only positive</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">slv</span><span class="o">.</span><span class="n">paramTypes</span><span class="p">)</span> <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Reference frame Corrections&#39;</span><span class="p">]</span>
<span class="n">mprior</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">100.</span>
<span class="n">slv</span><span class="o">.</span><span class="n">ConstrainedLeastSquareSoln</span><span class="p">(</span><span class="n">mprior</span><span class="o">=</span><span class="n">mprior</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nnls&#39;</span><span class="p">)</span>

<span class="c1"># Restore: we restore the original structure of the model space</span>
<span class="n">slv</span><span class="o">.</span><span class="n">unequalizeParams</span><span class="p">()</span>

<span class="c1"># Distribute results</span>
<span class="n">slv</span><span class="o">.</span><span class="n">distributem</span><span class="p">()</span>

<span class="c1"># Show me some stuff</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Basin pressure drop: </span><span class="si">{}</span><span class="s1"> MPa&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">basin</span><span class="o">.</span><span class="n">deltapressure</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Deep slip rate: </span><span class="si">{}</span><span class="s1"> mm/yr&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">deep</span><span class="o">.</span><span class="n">slip</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------
---------------------------------
Initializing solver object
Not a fault detected
Number of data: 3554
Number of parameters: 1305
Parameter Description ----------------------------------
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
Short North Anatolian Fault Final||   0 - 1292 ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
Deep NAF                      ||1292 - 1297 ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
East NAF                      ||1297 - 1298 ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
West NAF                      ||1298 - 1299 ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
Ismetpasa basin               ||None        ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
Reference frame Corrections   ||None        ||None        ||None        ||None        ||1300 - 1305
Parameter Description ----------------------------------
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
East NAF                      ||1292 - 1293 ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Pressure    ||Extra Parms
Ismetpasa basin               ||1294 - 1295 ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
Reference frame Corrections   ||None        ||None        ||None        ||None        ||1295 - 1300
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
Short North Anatolian Fault Final||   0 - 1292 ||None        ||None        ||None        ||None
-----------------
Fault Name                    ||Strike Slip ||Dip Slip    ||Tensile     ||Coupling    ||Extra Parms
West NAF                      ||1293 - 1294 ||None        ||None        ||None        ||None
-----------------
Equalized parameter indexes: [1292, 1293, 1294, 1295, 1296] --&gt; 1300
---------------------------------
---------------------------------
Computing the Constrained least squares solution
Final data space size: 3554
Final model space size: 1301
Computing the inverse of the model covariance
Computing the inverse of the data covariance
Performing non-negative least squares
Basin pressure drop: 7.15632060383285 MPa
Deep slip rate: 26.065292623447448 mm/yr
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show me</span>

<span class="c1"># Create a figure</span>
<span class="n">gp</span> <span class="o">=</span> <span class="n">geoplt</span><span class="p">(</span><span class="mf">31.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">35.5</span><span class="p">,</span> <span class="mf">42.</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">)))</span>

<span class="c1"># Plot the faults</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">naf</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma_r</span><span class="p">,</span>
                <span class="n">cbaxis</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;Slip rate (mm/yr)&#39;</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">deep</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma_r</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">east</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma_r</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">faultpatches</span><span class="p">(</span><span class="n">west</span><span class="p">,</span> <span class="n">slip</span><span class="o">=</span><span class="s1">&#39;strikeslip&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">plot_on_2d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma_r</span><span class="p">)</span>

<span class="c1"># Set views</span>
<span class="n">gp</span><span class="o">.</span><span class="n">setzaxis</span><span class="p">(</span><span class="mf">30.</span><span class="p">)</span>
<span class="n">gp</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">280.</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">))</span>
<span class="n">gp</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">showFig</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fault&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_34_0.png" src="../_images/notebooks_tutoInversionCreep_34_0.png" />
</div>
</div>
<p>An interesting exercise is to use the equalizeParams to link the slip value of the deep elements of the naf fault object to those slipping at depth. We did this for the Jolivet et al 2023 paper. However, in this case, since we use the AlTar sampler and no form of regularization through the model covariance matrix, the case is simpler.</p>
</section>
</section>
<section id="Computing-Predictions">
<h2>Computing Predictions<a class="headerlink" href="#Computing-Predictions" title="Link to this heading">¶</a></h2>
<p>Now that we are happy with a model, we can compute the predictions and compare them to the data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute synthetic</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">Datas</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">buildsynth</span><span class="p">([</span><span class="n">deep</span><span class="p">,</span> <span class="n">naf</span><span class="p">,</span> <span class="n">west</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">basin</span><span class="p">],</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>

<span class="c1"># Compute the transformations and remove them from the data</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">Datas</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">removeTransformation</span><span class="p">(</span><span class="n">trans</span><span class="p">)</span>

<span class="c1"># If for some reason, you want to add the transformation to the prediction, you can compute them and then add them to the synth attribute</span>
<span class="c1"># for data in InSARs:</span>
<span class="c1">#       data.computePoly(trans)</span>
<span class="c1">#       data.synth += data.poly</span>
<span class="c1"># for data in [ismenet]:</span>
<span class="c1">#      data.computeTransformation(trans)</span>
<span class="c1">#      data.synth += data.tranformation</span>
</pre></div>
</div>
</div>
</section>
<section id="Showing-the-results">
<h2>Showing the results<a class="headerlink" href="#Showing-the-results" title="Link to this heading">¶</a></h2>
<p>The fit to the GNSS data is not that great, but, to be fair, we are using a simplified problem with a lot of smoothing… So there is so much one can do. Now it is up to you to improve this.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We plot the GNSS data and the residuals</span>
<span class="n">box</span> <span class="o">=</span> <span class="p">[</span><span class="mf">32.5</span><span class="p">,</span> <span class="mf">33.5</span><span class="p">,</span> <span class="mf">40.75</span><span class="p">,</span> <span class="mf">41.05</span><span class="p">]</span>
<span class="n">ismenet</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;synth&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="mf">100.</span><span class="p">,</span> <span class="n">faults</span><span class="o">=</span><span class="p">[</span><span class="n">naf</span><span class="p">],</span> <span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="p">)</span>
<span class="n">ismenet</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;res&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">legendscale</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">25.</span><span class="p">,</span> <span class="n">faults</span><span class="o">=</span><span class="p">[</span><span class="n">naf</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_39_0.png" src="../_images/notebooks_tutoInversionCreep_39_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_39_1.png" src="../_images/notebooks_tutoInversionCreep_39_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We show the InSAR data and the residuals</span>
<span class="k">for</span> <span class="n">sar</span> <span class="ow">in</span> <span class="n">InSARs</span><span class="p">:</span>
    <span class="n">sar</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plotType</span><span class="o">=</span><span class="s1">&#39;decimate&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span> <span class="n">edgewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
             <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma</span><span class="p">,</span> <span class="n">cbaxis</span><span class="o">=</span><span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;LOS velocity (mm/yr)&#39;</span><span class="p">)</span>
    <span class="n">sar</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plotType</span><span class="o">=</span><span class="s1">&#39;decimate&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;synth&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span> <span class="n">edgewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
             <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma</span><span class="p">,</span> <span class="n">cbaxis</span><span class="o">=</span><span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;LOS velocity (mm/yr)&#39;</span><span class="p">)</span>
    <span class="n">sar</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plotType</span><span class="o">=</span><span class="s1">&#39;decimate&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;res&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span> <span class="n">edgewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
             <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">roma</span><span class="p">,</span> <span class="n">cbaxis</span><span class="o">=</span><span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;LOS velocity (mm/yr)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_40_0.png" src="../_images/notebooks_tutoInversionCreep_40_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_40_1.png" src="../_images/notebooks_tutoInversionCreep_40_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_40_2.png" src="../_images/notebooks_tutoInversionCreep_40_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_40_3.png" src="../_images/notebooks_tutoInversionCreep_40_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_40_4.png" src="../_images/notebooks_tutoInversionCreep_40_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_40_5.png" src="../_images/notebooks_tutoInversionCreep_40_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_40_6.png" src="../_images/notebooks_tutoInversionCreep_40_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_40_7.png" src="../_images/notebooks_tutoInversionCreep_40_7.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tutoInversionCreep_40_8.png" src="../_images/notebooks_tutoInversionCreep_40_8.png" />
</div>
</div>
<p>That’s it for now!</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">CSI</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../basictutorials.html">Basic Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CSIpublications.html">CSI Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classes.html">Classes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../basictutorials.html">Basic Tutorials</a><ul>
      <li>Previous: <a href="tutoInSAR.html" title="previous chapter">A tutorial for InSAR data in CSI</a></li>
      <li>Next: <a href="tutoPressureSource.html" title="next chapter">A tutorial for pressure sources in CSI</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Romain Jolivet.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/notebooks/tutoInversionCreep.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>